# 📜 変更履歴

このファームウェアの主な変更点は全てこのファイルに記録されます。  
フォーマットは [Keep a Changelog](https://keepachangelog.com/) に基づいています。

## [ v4.7 ] - 2024-08-26

#### ✨ 機能追加

- M5 Weight Unit I2C センサをサポート
- リリースタグの表示に対応（ESP32 Devkit を除く）

#### 🐞 不具合修正

- GPIO の量子化が正しく作用しない不具合の修正

## [ v4.6 ] - 2024-02-13

#### ✨ 機能追加

- 対応 I2C ハブの追加

#### 🐞 不具合修正

- HTTP 送信で実数値が正常に送信できない不具合の修正

## [ v4.5 ] - 2024-01-13

#### 📝 機能変更

- カメラ画像の向きを修正
- データ送信後に SNS2 の DC パルスカウントをリセットするように変更

#### 🐞 不具合修正

- 画面表示の応答性を改善
- SHT3X の初期化に失敗する不具合の修正

## [ v4.4 ] - 2023-12-10

#### ✨ 機能追加

- BME68x センサをサポート
- SHT4x センサをサポート
- CHANGELOG.md を追加
- NIC の MAC アドレスを取得する API を追加

#### 📝 機能変更

- 一部デバイスでのビルドサイズの削減

#### 🐞 不具合修正

- 一部センサで画面表示が更新されない不具合の修正
- DS18B20 (DS2485) が初期化できない不具合の修正

## [ v4.3 ] - 2023-10-06

#### 🐞 不具合修正

- M5Stack Basic でスピーカーからノイズが出る不具合の修正
- DS2485 の動作モードが正しく判定できない不具合の修正

## [ v4.2 ] - 2023-09-25

#### ✨ 機能追加

- M5Stack CoreS3 をサポート
- M5Stack CoreS3 用のビルドバッチファイルを追加
- M5Stack CoreS3 用のビルドバッチファイルを追加
- M5Unit_KMeterISO センサをサポート
- M5Unit_4-20mA センサをサポート
- カメラデバイスをサポート
- Serial 経由での情報取得機能を実装
- カメラ画像送信用の処理と API を追加
- カメラ画像の表示機能を追加

#### 📝 機能変更

- 容量の問題で WioTerminal の機能を一部制限
- WioTerminal の Flash 節約のための細かな調整
- 送信タイミング検出方法をタイマから RTC に変更
- カメラライブラリとのコンフリクト回避のため、adafluit ライブラリを調整
- ライセンスのため、SD の名称を TF に変更
- バッチファイルに echo off を追加
- フォント情報の調整
- コメントを hal_api.h に集約
- 画像表示用に Grafana のプラグインを追加

#### 🐞 不具合修正

- km-n1-flk の小数点以下の値が取得できない不具合の修正
- M5Tough でボタンが反応しない不具合の修正

## [ v4.1 ] - 2023-07-18

#### ✨ 機能追加

- SEN54 センサをサポート
- ライブラリの追加

#### 📝 機能変更

- フォントファイルのアップデート
- AtomS3 の不要なシリアル出力を削除

#### 🐞 不具合修正

- M5Station で WiFi の状態が表示されない不具合の修正
- M5Stick C Plus でボタンが正常動作しない不具合の修正
- M5AtomS3 での表示不具合の修正
- MQTT でハートビート信号が送信されない不具合の修正

## [ v4.0 ] - 2023-07-14

#### ✨ 機能追加

- M5AtomS3 をサポート
- M5Station をサポート
- Modbus RTU をサポート
- W5500 をサポート
- Ethernet サポート
- KM-N1-FLK センサをサポート
- KW7M センサをサポート
- M5AmMeterUnit センサをサポート
- SensingEye73X シリーズのセンサをサポート
- YPMS-482P センサをサポート
- InputRegister メソッドを追加
- リンク送信機能の実装
- 状態変化送信機能の実装
- Info 画面の追加
- サブタイマ機能の実装
- 乱数 API を追加
- Modbus 用のインタフェースクラスの実装
- M5Stack に Ethernet 用の NTP 同期処理を追加
- コンフィグメモを追加
- Ethernet 用のアイコンを追加

#### 📝 機能変更

- ADS1115 で AD 値が取得できるようにライブラリを変更
- ボタンライブラリの挙動変更に伴う押下検出処理の変更
- 送信タイミングでもデータを更新するように変更
- Modbus RTU ライブラリを修正しタイムアウトエラーを実装
- ZIGBEE_API_MAX_FRAME_SIZE をデバイス毎に変えられるように変更
- Modbus の設定項目を変更
- Modbus の HAL API を変更
- GPIO の初期化を効率化
- JSON サイズの調整
- ボタン待機処理の効率化
- enum class への変更
- センサタイマの検出方法を変更
- ランダムウェイトの間隔を変更
- いくつかの wdt 用 delay を追加
- 既存メソッドの改名
- タイマ処理の変更
- タイマ処理の変更に伴う表示系の修正
- M5Unified を使用するように変更
- WioTerminal の NTP 同期処理を修正
- 共通設定パラメータを分割
- 使用フォント文字をアップデート

#### 🐞 不具合修正

- RFID のバグを修正
- 画面処理の軽微な修正

## [ v3.10 ] - 2023-06-19

#### ✨ 機能追加

- M5 Extend I/O Unit2 センサをサポート
- BH1750FVI センサをサポート
- 溶存酸素（Atlas Scientific）センサをサポート
- DT_S1 センサをサポート

## [ v3.9 ] - 2023-01-22

#### ✨ 機能追加

- M5Stick C Plus をサポート
- MCP9600 センサをサポート
- DS2485 センサをサポート
- DS18B20 over DS2485 センサをサポート
- SCD4x センサをサポート
- M5Unit_KMeter センサをサポート

#### 📝 機能変更

- メモリ使用量の削減コードを実装
- ADS1100 の判定処理を追加
- ADS1100 の出力を電圧値に変更
- VL53L0X のデータ取得エラーを検知するように修正
- KMeter のデータ取得の安定性を向上

#### 🐞 不具合修正

- 描画の修正
- Devkit で設定モードに入れない不具合の修正

## [ v3.8 ] - 2022-10-25

#### ✨ 機能追加

- ボードマネージャを 2.0.4 にアップデート
- 起動時にボードマネージャ番号をデバッグ出力する機能を追加（ESP32 系のみ）
- FreeType のバージョンとクレジットをシリアルに出力する機能の追加
- WiFi の手動切断機能を追加
- SONIC_I2C センサモジュールをサポート
- 初期化終了時のコールバック関数を追加
- ADS1115 センサをサポート

#### 📝 機能変更

- OFR v1.0 に対応
- メモリ状態をシリアルに表示する用に修正
- OFR のエラーを出力するように変更
- センサ値表示処理を修正
- M5Stack Basic ライブラリを更新
- Ultra Sonic ライブラリを更新
- 設定アプリとの通信を安定化
- 不要なデバッグ出力の削除
- SC16IS7XX センサをサポート
- A02YYUW をサポート（SC16IS7XX の 0x4D に割り当て）
- I2C デバイス管理のメモリ効率化
- MQTT のハートビートの Topic を変更
- I2C センサエラーを画面に表示するように変更

#### 🐞 不具合修正

- ESP32 系の TIM2 の不具合解決のために TIM3 に変更
- センサの単位が間違っている不具合を修正
- 設定アプリとの通信が失敗した場合に復帰できない問題の修正
- M5Stack Tough のボタンプログラムバグの修正
- WioTerminal で超音波距離センサが使えない問題へ
- 表示系の不具合を修正
- ParamManager の設定が上書きされない不具合の修正
- setting.js が無い状態だと起動に失敗する不具合の修正

## [ v3.7 ] - 2022-08-29

#### ✨ 機能追加

- BME280 センサをサポート
- ATMICL_ONE SNS2 センサをサポート
- ATMICL_ONE AN16 センサをサポート
- ATMICL_ONE ANDS センサをサポート
- Wio Terminal のバッテリーアクセサリをサポート

#### 📝 機能変更

- ログファイル名決定アルゴリズムの修正
- ログファイルの最大行数を 2000 行に変更

## [ v3.6 ] - 2022-06-16

#### ✨ 機能追加

- WioTerminal に WDT 機能を追加
- Ambient での送信データ判定用処理の追加

#### 🐞 不具合修正

- Ambient データストアの不具合を修正
- 送信不要なデータもストアしていた不具合を修正

## [ v3.5 ] - 2022-06-08

#### 🐞 不具合修正

- ESP32 系で WiFi 再接続がうまくいかない不具合の修正
- WiFi 再接続時にアイコンが正常に描画されない不具合の修正
- ボタン状態取得の呼び出し関数が間違っていた問題を修正
- I2C データ取得結果が未初期化だった問題を修正
- WioTerminal のファイルシステムの軽微な修正

## [ v3.4 ] - 2022-05-18

#### ✨ 機能追加

- SD カードでのロギング機能を実装
- SD18B20 でのパラサイトモードでの動作をサポート
- WioTerminal でのデバッグ出力の追加
- SD カードアイコンの追加

#### 📝 機能変更

- WioTerminal での送信タスクのスタックサイズを調整
- 定期実行処理関数をタスクごとに分離
- SD18B20 の初期化安定性の向上

## [ v3.3 ] - 2022-04-25

#### ✨ 機能追加

- デバッグ用メッセージの表示を追加（Wio）
- mutex 機能を実装

#### 📝 機能変更

- WioTerminal の タスクメモリサイズを調整
- 不要なメモリを開放するように修正

## [ v3.2 ] - 2022-04-22

#### 🐞 不具合修正

- Heartbeat 送信がされていない不具合の修正（1 分毎）
- 送信残データ数のカウントミスが発生する可能性を低減
- MQTT Broker との接続が切れる不具合を修正

## [ v3.1 ] - 2022-04-21

#### 📝 機能変更

- いくつかの共通設定項目を削除し簡略化
- データバッファサイズを調整
- SCD30 のリセット処理を追加

#### 🐞 不具合修正

- パラメータ読み込みパスの間違いを修正

## [ v3.0 ] - 2022-04-19

#### ✨ 機能追加

- 他のエッジデバイスに対応できるようにプログラムを大幅に変更

## [ v2.29 ] - 2021-09-16

#### ✨ 機能追加

- DS2484（DS18B20） センサをサポート
- 自作 I2C-OneWire トランスレータをサポート

#### 📝 機能変更

- TTF レンダラを OpenFontRender に変更

## [ v2.0 - 2.28]

未公開

## [ v1.0 - 1.4]

未公開
